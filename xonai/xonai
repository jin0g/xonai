#!/bin/sh  
# xonai - Launch xonsh with xonai extension loaded

# Set environment variable to indicate xonai mode
export XONAI_AUTOLOAD=1

# If .xonairc exists, use it; otherwise create minimal auto-load
if [ -f "$HOME/.xonairc" ]; then
    # User has .xonairc - check if it loads xonai xontrib
    if ! grep -q "xontrib load xonai" "$HOME/.xonairc" 2>/dev/null; then
        # Add auto-load to the end of existing .xonairc 
        echo "xontrib load xonai  # Auto-added by xonai launcher" >> "$HOME/.xonairc"
    fi
    exec xonsh --rc "$HOME/.xonairc" "$@"
else
    # No .xonairc - create a minimal one and use it
    echo "xontrib load xonai  # Auto-created by xonai launcher" > "$HOME/.xonairc"
    exec xonsh --rc "$HOME/.xonairc" "$@"
fi